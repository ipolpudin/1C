//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

                                                                                                      Общее

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                Проверка настроек
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Чек лист по настройке контура
https://kb.1c.ru/articleView.jsp?id=102
https://kb.1c.ru/articleView.jsp?id=88

Настройки MSQL
https://kb.1c.ru/articleView.jsp?id=100

Postgres
https://kb.1c.ru/articleView.jsp?id=23
https://kb.1c.ru/articleView.jsp?id=91

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                Рекомендованные настройки
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
1) В windows устрановить "Высокач производительность" / В linus установить performance
2) https://its.1c.ru/db/metod8dev/content/5810/hdoc 
или https://v8.1c.ru/tekhnologii/tekhnologii-krupnykh-vnedreniy/vypolnennye-proekty-tsktp/oborudovanie-na-realnykh-vnedreniyakh/ - Расчет параметров серверного оборудования 
3) Выносить фоновые задания и внешние компоненты на новый рабочий сервер


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                Масштабирование СУБД
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Инф: Подготовка к 1СЭксперту по технологическим вопросам. Основной курс\02_Простые способы ускорить 1С

В основном требуетсы масштабировать именно севрве СУБД

Виды:
1) Масштабировать на чтение
Вынести тяжелые запросы в отдельную базу, 1с репликация и Дата акселератор. В СКД есть функция выполнять запросы в копии базы

1) Масштабировать на чтение и запись
1) Масштабировать только хранение данных, но сервер один 
1) Масштабировать нагрузку на несколько серверов

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                План поиска и устранения проблем
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Инф: Подготовка к 1СЭксперту по технологическим вопросам. Основной курс\03_Инструменты и методики

1) Показатель здоровья
APDEX, Среднее время выполнения операции
Это сигнализирует о том, что необходимо действовать. Устанавливать точки мониторинга на новых ключевых операциях 

2) Загруженность железа
В командном окне Windows выполнить "perfmon" - системный мониторин. Настроить сбор загруженности системы

3) Показатели здоровья СУБД
Счетчики СУБД, динамические представления (Код для СУБД)

4) Поиск виновного
Технологический журнал 1с, логи Postgres, трасировка MS SQL, динамические представления СУБД, замер производительности + средства

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                                                Анализ и проблемы железа
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Использовать счетчик perfmon в Windows для логирования загруженности железа.
Классические счетчики: 
1) Загруженность процессора
2) Текущая длина очереди диска
3) Загруженность процессора (Сведения о процесоре) для многоядерной особенно актуально
4) Доступно Мб памяти (Физическая)
4) % процент свободного места (Логический)
5) Среднее время обращения к диску. Разделять на запись к диску
6) Сетевой интерфейс -> Всего байт/с

Нюансы:
Процессор:
1) Обращать внимание на распределение загруженности процессора по NUMA узлам и распределение по ядрам. Процессор можем быть не загруже (50%), а на некоторых ядрах (100%). 
Нужно правильно подбирать колическо rphost 02_Производительность железа Виндовс
2) Лицензии раздали не на все количества ядер, происходит простой ядер без лицензий
3) 
