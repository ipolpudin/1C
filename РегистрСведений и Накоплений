//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                         //РегистрСведений
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

НаборЗаписи - Изменить и Создать
МенеджерЗаписи - только Создает



Есть таблица итогов на СрезПервых и СрезПоследних, только при включении галочки.



НаборЗаписейРегистра.Записать(Ложь)// ложь - свойство перезаписать гранулу отбора
// Если стоит Истина то перезапишется регистр по выбранной грануле отбора
// По умолчанию стоит Истина
По умолчанию запись выполняется с замещением, т. е. существующие записи этого регистратора в регистре сведений будут удалены.
Для того чтобы добавить записи к существующим записям по выбранной грануле отбора, необходимо указывать значение Ложь параметра метода Записать() набора записей.


//Гранула Отбора 
НаборЗаписейРегистра.Отбор.Период.Установить(Параметры.ДатаЗаписиРегистра); 
НаборЗаписейРегистра.Отбор.Подразделение.Установить(Параметры.ВедущийОбъект);



//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//Запись в РегистрСведений через ТаблизуЗначений

Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ПодразделенияОрганизаций.эккоИдентификаторSAPHRПозицииШРРуководителя КАК Идентификатор,
	|	ПодразделенияОрганизаций.ДатаСоздания КАК Период,
	|	ПодразделенияОрганизаций.Ссылка КАК Подразделение
	|ИЗ
	|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
	|ГДЕ
	|	ПодразделенияОрганизаций.эккоИдентификаторSAPHRПозицииШРРуководителя <> """"";
	Результат = Запрос.Выполнить();
	
	
	таб = Результат.Выгрузить();	
	
	
	
	НаборЗаписей = РегистрыСведений.эккоИсторияИзмененияSapHR.СоздатьНаборЗаписей();
	НаборЗаписей.Загрузить(таб);
	НаборЗаписей.Записать();
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
 	//Записывает новые записи в Регистр Сведений
	
	&НаСервере
	НаборЗаписейРегистра = РегистрыСведений.эккоИсторияИзмененияSapHR.СоздатьНаборЗаписей();
	НаборЗаписейРегистра.Отбор.Период.Установить(Параметры.ДатаЗаписиРегистра); 
	НаборЗаписейРегистра.Отбор.Подразделение.Установить(Параметры.ВедущийОбъект);

	НаборЗаписейРегистра = НаборЗаписей.Добавить();
	НаборЗаписейРегистра.Период = Параметры.ДатаЗаписиРегистра;
	НаборЗаписейРегистра.Подразделение = Параметры.ВедущийОбъект;
	
	НаборЗаписейРегистра.Записать(Ложь)// ложь - свойство перезаписать элемент
	/////////////////////////////////////////////////////////////////
	
	Для Каждого ЗаписьНабора Из эккоИсторияИзмененияSapHRПозицииРуководителя Цикл
		ЗаполнитьЗначенияСвойств(НаборЗаписейРегистра.Добавить(), ЗаписьНабора);
	КонецЦикла; 
	
	НаборЗаписейРегистра.Записать(Ложь);
  
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //Поиск в Регистре Сведений
	
	//ВыборкаЗаписи - содержит записи удовлетворяющие отбор
	&НаСервере
        СтруктураОтбора = Новый Структура; 
	СтруктураОтбора.Вставить("Подразделение", Подразделение);
	
	ВыборкаЗаписи = РегистрыСведений.эккоИсторияИзмененияSapHR.Выбрать(ДатаЭлемента, ДатаЭлемента,СтруктураОтбора);
	
	Пока ВыборкаЗаписи.Следующий() Цикл
	КонецЦикла;
	
	
	Если НЕ ВыборкаЗаписи.Следующий() Тогда
	КонецЕсли;
	
	
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	
	//Находит последннюю актуальную запись в Регистре Сведений в Виде ТЗ
	&НаСервере
	Запись = РегистрыСведений.эккоИсторияИзмененияSapHR.СрезПоследних(Дата,СтруктураОтбора);
	
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	
	//Находит последннюю актуальную запись в Регистре Сведений в Виде ТЗ. Возвращает только Ресурсы
	
	&НаСервере
	Запись = РегистрыСведений.эккоИсторияИзмененияSapHR.ПолучитьПоследнее(Дата,СтруктураОтбора);
	
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	
	//Удаление записей по выбранной грануле(отбору)
	
	НаборЗаписейРегистра = РегистрыСведений.эккоИсторияИзмененияSapHRПозицииРуководителя.СоздатьНаборЗаписей();
	НаборЗаписейРегистра.Отбор.Подразделение.Установить(Объект.Ссылка);
	НаборЗаписейРегистра.Записать();


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                         //РегистрНакоплений
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Есть 2 физические таблицы: Движений и Таблицы Итогов(остатков)
Есть таблица итогов у остатков, переодичность сохраниния зависит от параметра "Переодичность". Есть нюанс если дата запроса к таблице остатков актуальнее чем физическая, то она будет досчитывать до нужной даты
У таблицы Обороды вычисление на необходимую дату происходит подсчетом всей таблицы



